(function(){var c,f,e,a,b;function d(a){s.testProcessor&&s.testProcessor(a)}function l(a){if(window.ActiveXObject){var d=new ActiveXObject("Microsoft.XMLDOM");d.async="false";d.loadXML(a);if(d.parseError.errorCode!=0)throw txt="XML Parsing failed error Code: "+d.parseError.errorCode+"\n",txt=txt+"Reason: "+d.parseError.reason,txt=txt+"Failed at line: "+d.parseError.line,new q(txt);else return true}else if(document.implementation.createDocument)if(d=(new DOMParser).parseFromString(a,"text/xml"),d.getElementsByTagName("parsererror").length>
0)throw new q("parse error");else return true;else throw new q("Your browser cannot handle XML validation");}function h(a,d,b){b&&(a[d]||(a[d]=[]),a[d].push(b))}function g(a){return n?a.name():a.localName}function k(a,d,b){var e=null;n?a.attr(d)&&(e=a.attr(d).value()):e=a.getAttribute(d);return!e?b:e}function m(a){var d,b,e,c="";e=n?a.childNodes().length:a.childNodes.length;for(d=0;d<e;d++)b=n?a.childNodes()[d]:a.childNodes[d],c+=n?b.text():b.textContent;c=c.replace(/\s+/g," ");c=c.replace(/^\s*/g,
"");return c=c.replace(/\s*$/g,"")}function p(a,d,b){if(!a)throw new Exception("Expecting node with name ["+d+"] but node was not defined...");if(g(a)!==d)throw new q("Expecting node with name ["+d+"] but found a ["+g(a)+"]");if((n?a.namespace().href():a.namespaceURI)!==b)throw new q("Expecting node with namespace ["+b+"] but found a ["+(n?a.namespace().href():a.namespaceURI)+"]");}function o(a,d,b){var e=false,c,l,f,h;h=n?a.childNodes().length:a.childNodes.length;for(l=0;l<h;l++)if(f=n?a.childNodes()[l]:
a.childNodes[l],n?f.type()==="element":f.nodeType===1){for(c=0;c<d.length;c++)if(!(d[c].name&&d[c].name!==g(f))&&!(d[c].namespace&&d[c].namespace!==(n?f.namespace().href():f.namespaceURI)))d[c].callback(f,c),e=true;!e&&typeof b==="function"&&b(f)}}function t(a){s=a}var n=false,v,r,s={},q,i;typeof window=="undefined"&&(v=require("libxmljs"),n=true);MDEntityDescriptor=function(){};MDEntityDescriptor.prototype.hasCertOfType=function(a){var d;if(!this.saml2sp||!this.saml2sp.certs)return false;for(d=0;d<
this.saml2sp.certs.length;d++){if(this.saml2sp.certs[d].use==="both")return true;if(this.saml2sp.certs[d].use===a)return true}return false};i=function(a,d,b,e){this.id=a;this.significance=null;this.value=typeof b!=="undefined"?b:2;if(typeof e!=="undefined")this.significance=e;this.text=d};i.prototype.getLevel=function(){return this.significance===0||this.value===2?"info":this.value===1?"ok":this.significance===1?"warning":"error"};i.prototype.html=function(){var a,d,b;d="samlmetajs_testvalue"+this.value;
b="";this.significance!==null&&(b="samlmetajs_sigvalue"+this.significance);a=this.text;return a='<div class="samlmetajs_testentry samlmetajs_testentry_'+this.id+" "+d+" "+b+'">'+a+"</div>"};q=function(a){this.name="Generic SAML Parser Error";this.message=a};c="urn:oasis:names:tc:SAML:2.0:metadata";f="urn:oasis:names:tc:SAML:metadata:ui";e="urn:oasis:names:tc:SAML:metadata:attribute";a="urn:oasis:names:tc:SAML:2.0:assertion";b="http://www.w3.org/2000/09/xmldsig#";reader=function(){this.result=null};
validateEmail=function(a){return/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(a)};validateURL=function(a){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(a)};isHTTPS=function(a){return/(https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(a)};r=function(j){function t(a){var d=null;return n?v.parseXmlString(a).document().root():(d=new DOMParser,d.parseFromString(a,"text/xml").documentElement)}function q(a){var e=
{};p(a,"KeyDescriptor",c);e.use=k(a,"use","both");o(a,[{namespace:b,name:"KeyInfo",callback:function(a){o(a,[{namespace:b,name:"X509Data",callback:function(a){o(a,[{namespace:b,name:"X509Certificate",callback:function(a){e.cert=m(a)}}])}}])}}]);e.cert||d(new i("certdatamissing","Could not extract certificate data properly from KeyDescriptor element ",0,1));return e}function s(a){var b={},e;p(a,"ContactPerson",c);e=k(a,"contactType");b.contactType=e;o(a,[{namespace:c,name:"Extensions",callback:function(){d(new i("contactextension",
"SAMLmetaJS has not yet implemented support for parsing Extensions in ContactPerson"))}},{namespace:c,name:"GivenName",callback:function(a){b.givenName=m(a)}},{namespace:c,name:"SurName",callback:function(a){b.surName=m(a)}},{namespace:c,name:"EmailAddress",callback:function(a){b.emailAddress=m(a);validateEmail(b.emailAddress)||d(new i("emailaddressformat","EmailAddress of ContactPerson was in invalid format",0,1))}},{namespace:c,name:"Company",callback:function(a){b.company=m(a)}},{namespace:c,name:"TelephoneNumber",
callback:function(a){b.telephoneNumber=m(a)}}],function(a){d(new i("unknowncontactpersonelement","Unexpected child element of ContactPerson ["+g(a)+"]",0,1))});return b}function r(a){var d={};d.Binding=k(a,"Binding",null);d.Location=k(a,"Location",null);d.ResponseLocation=k(a,"ResponseLocation",null);d.index=k(a,"index",null);return d}function w(a){var b={};p(a,"AttributeConsumingService",c);if(!b.name)b.name={};if(!b.descr)b.descr={};b.attributes={};o(a,[{namespace:c,name:"ServiceName",callback:function(a){var d=
k(a,"xml:lang","en"),a=m(a);b.name[d]=a}},{namespace:c,name:"ServiceDescription",callback:function(a){b.descr[k(a,"xml:lang","en")]=m(a)}},{namespace:c,name:"RequestedAttribute",callback:function(a){(a=k(a,"Name"))&&(b.attributes[a]=1)}}],function(a){d(new i("acsunknownchild","Unexpected child element of AttributeConsumingService ["+g(a)+"]",0,1))});return b}function x(b){var e={},c=[];p(b,"Attribute",a);e.name=k(b,"Name",null);e.nameFormat=k(b,"NameFormat",null);o(b,[{namespace:a,name:"AttributeValue",
callback:function(a){c.push(m(a))}}],function(a){d(new i("unknownattributecontent","Unexpected child element of Attribute ["+g(a)+"]",0,1))});e.values=c;return e}function y(a){var b={};p(a,"UIInfo",f);o(a,[{namespace:f,name:"DisplayName",callback:function(a){if(!b.name)b.name={};b.name[k(a,"xml:lang","en")]=m(a)}},{namespace:f,name:"Description",callback:function(a){if(!b.descr)b.descr={};b.descr[k(a,"xml:lang","en")]=m(a)}},{namespace:f,name:"GeolocationHint",callback:function(a){b.location=m(a).substr(4)}}],
function(a){d(new i("mduiunknownchild","Parsing of this child element of MDUI not yet implemented ["+g(a)+"]"))});return b}function z(b,e){p(b,"Extensions",c);o(b,[{namespace:f,name:"UIInfo",callback:function(a){e.mdui=y(a)}},{namespace:a,callback:function(a){d(new i("extillegalnamespacesaml","Illegal namespace (saml) in Extensions at SPSSODescriptor ["+g(a)+"]",0,2))}},{namespace:c,callback:function(a){d(new i("extillegalnamespacemd","Illegal namespace (md) in Extensions at SPSSODescriptor ["+g(a)+
"]",0,2))}}],function(a){d(new i("notimplementedssoext","Parsing Extensions at SPSSODescriptor with ["+g(a)+"] not implemented"))})}function A(a){var b={};p(a,"SPSSODescriptor",c);o(a,[{namespace:c,name:"Extensions",callback:function(a){z(a,b)}},{namespace:c,name:"KeyDescriptor",callback:function(a){h(b,"certs",q(a))}},{namespace:c,name:"SingleLogoutService",callback:function(a){a=r(a);h(b,"SingleLogoutService",a);validateURL(a.Location)||d(new i("SingleLogoutServiceInvalidURL","SingleLogoutService/@Location was not a valid URL",
0,2))}},{namespace:c,name:"AssertionConsumerService",callback:function(a){a=r(a);h(b,"AssertionConsumerService",a);validateURL(a.Location)||d(new i("AssertionConsumerServiceInvalidURL","AssertionConsumerService/@Location was not a valid URL",0,2))}},{namespace:c,name:"AttributeConsumingService",callback:function(a){b.acs=w(a)}}],function(a){d(new i("saml2spunknownchild","Parsing this child of SPSSODescr not yet implemented ["+g(a)+"]"))});return b}function B(a){var b={name:{},displayname:{},url:{}};
p(a,"Organization",c);o(a,[{namespace:c,name:"OrganizationName",callback:function(a){b.name[k(a,"xml:lang","en")]=m(a)}},{namespace:c,name:"OrganizationDisplayName",callback:function(a){b.displayname[k(a,"xml:lang","en")]=m(a)}},{namespace:c,name:"OrganizationURL",callback:function(a){var e=m(a);b.url[k(a,"xml:lang","en")]=e;validateURL(e)||d(new i("OrganizationURLInvalidURL","OrganizationURL was not a valid URL",0,2))}}],function(a){d(new i("OrganizationunknownElement","Child element of Organization "+
g(a)+" not yet implemented"))});return b}function C(b){var l={};p(b,"EntityAttributes",e);o(b,[{namespace:a,name:"Attribute",callback:function(a){a=x(a);a.name&&(l[a.name]=a)}},{namespace:a,name:"Assertion",callback:function(){d(new i("notimplementedentattributesassertion","Parsing EntityAttributes with <Assertion> is not yet implemented"))}},{namespace:c,callback:function(a){d(new i("extillegalnamespacemdent","Illegal namespace (md) in Extensions at EntityDescriptor ["+g(a)+"]",0,2))}}],function(a){d(new i("notimplementedentext",
"Parsing Extensions at EntityDescriptor with ["+g(a)+"] not implemented"))});return l}function D(b,l){p(b,"Extensions",c);o(b,[{namespace:e,name:"EntityAttributes",callback:function(a){l.entityAttributes=C(a)}},{namespace:a,callback:function(a){d(new i("extillegalnamespacesamlent","Illegal namespace (saml) in Extensions at EntityDescriptor ["+g(a)+"]",0,2))}},{namespace:c,callback:function(a){d(new i("extillegalnamespacemdent","Illegal namespace (md) in Extensions at EntityDescriptor ["+g(a)+"]",
0,2))}}],function(a){d(new i("notimplementedentext","Parsing Extensions at EntityDescriptor with ["+g(a)+"] not implemented"))})}var u=null;try{l(j)}catch(E){return console.log(E.message),u=t('<md:EntityDescriptor xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"></md:EntityDescriptor>'),{}}u=t(j);j=function(a){var e,l;e=new MDEntityDescriptor;p(a,"EntityDescriptor",c);e.entityid=k(a,"entityID");if(l=k(a,"validUntil"))l=new Date(l),e.validUntil=l.getTime();
o(a,[{namespace:c,name:"Extensions",callback:function(a){D(a,e)}},{namespace:c,name:"SPSSODescriptor",callback:function(a){e.saml2sp=A(a)}},{namespace:c,name:"AttributeAuthorityDescriptor",callback:function(){console.log("Parsing AttributeAuthorityDescriptor not yet implemented...");d(new i("AttributeAuthorityDescriptorNotImplemented","Parsing AttributeAuthorityDescriptor not yet implemented"))}},{namespace:c,name:"IDPSSODescriptor",callback:function(){d(new i("IDPSSODescriptorNotImplemented","Parsing IDPSSODescriptor not yet implemented"))}},
{namespace:c,name:"Organization",callback:function(a){e.organization=B(a)}},{namespace:c,name:"ContactPerson",callback:function(a){h(e,"contacts",s(a))}},{namespace:b,name:"Signature",callback:function(){}}],function(a){d(new i("unknowntoplevelelement","SAMLmetaJS found an unexpected element as a child of the EntityDescriptor ["+g(a)+"]",0,1))});return e}(u);if(!j.name)if(j.saml2sp&&j.saml2sp.mdui&&j.saml2sp.mdui.name)j.name=j.saml2sp.mdui.name;else if(j.saml2sp&&j.saml2sp.acs&&j.saml2sp.acs.name)j.name=
j.saml2sp.acs.name;if(!j.descr)if(j.saml2sp&&j.saml2sp.mdui&&j.saml2sp.mdui.descr)j.descr=j.saml2sp.mdui.descr;else if(j.saml2sp&&j.saml2sp.acs&&j.saml2sp.acs.descr)j.descr=j.saml2sp.acs.descr;j.name||d(new i("noentityname","The entity did not include a name",0,1));j.descr||d(new i("noentitydescr","The entity did not include a description",0,1));(!j.saml2sp||!j.saml2sp.AssertionConsumerService)&&d(new i("noacsendpoint","The entity did not include an AssertionConsumerService endpoint",0,2));j.organization||
d(new i("noorganization","The entity does not have information about the Organization",0,1));j.contacts||d(new i("nocontacts","The entity does not have information about ContactPersons at all",0,1));j.hasCertOfType("signing")?d(new i("hascertsigning","The entity does have a signing certificate",1,1)):d(new i("hascertsigning","The entity does NOT have a signing certificate",0,1));j.hasCertOfType("encryption")?d(new i("hascertencryption","The entity does have a encryption certificate",1,1)):d(new i("hascertencryption",
"The entity does NOT have a encryption certificate",0,1));return j};n?exports.parseFromString=r:(window.mdreader={},window.mdreader.parseFromString=r,window.mdreader.setup=t)})();if(typeof console==="undefined"||typeof console.log==="undefined")var console={log:function(){}};
if(typeof DOMParser==="undefined")DOMParser=function(){},DOMParser.prototype.parseFromString=function(c,f){var e=null;if(typeof ActiveXObject!=="undefined")return e=new ActiveXObject("MSXML.DomDocument"),e.async=false,e.loadXML(c),e;else if(typeof XMLHttpRequest!=="undefined")return e=new XMLHttpRequest,f||(f="application/xml"),e.open("GET","data:"+f+";charset=utf-8,"+encodeURIComponent(c),false),e.overrideMimeType&&e.overrideMimeType(f),e.send(null),e.responseXML};var SAMLmetaJS={};
(function(c){SAMLmetaJS.plugins={};SAMLmetaJS.pluginEngine={execute:function(c,e){var a;if(SAMLmetaJS.plugins)for(a in SAMLmetaJS.plugins)SAMLmetaJS.plugins[a][c]&&SAMLmetaJS.plugins[a][c].apply(null,e)}};SAMLmetaJS.Constants={ns:{md:"urn:oasis:names:tc:SAML:2.0:metadata",mdui:"urn:oasis:names:tc:SAML:metadata:ui",mdattr:"urn:oasis:names:tc:SAML:metadata:attribute",saml:"urn:oasis:names:tc:SAML:2.0:assertion",xsd:"http://www.w3.org/2001/XMLSchema",ds:"http://www.w3.org/2000/09/xmldsig#"},certusage:{both:"Both",
signing:"Signing",encryption:"Encryption"},languages:{en:"English",no:"Norwegian (bokm\u00e5l)",nn:"Norwegian (nynorsk)",se:"S\u00e1megiella",da:"Danish",de:"German",sv:"Swedish",fi:"Finnish",es:"Espa\u00f1ol",fr:"Fran\u00e7ais",it:"Italian",nl:"Nederlands",lb:"Luxembourgish",cs:"Czech",sl:"Sloven\u0161\u010dina",lt:"Lietuvi\u0173 kalba",hr:"Hrvatski",hu:"Magyar",pl:"J\u0119zyk polski",pt:"Portugu\u00eas","pt-BR":"Portugu\u00eas brasileiro",tr:"T\u00fcrk\u00e7e",el:"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",
ja:"Japanese (\u65e5\u672c\u8a9e)"},contactTypes:{administrative:"Administrative",technical:"Technical",support:"Support",billing:"Billing",other:"Other"},endpointTypes:{sp:{AssertionConsumerService:"AssertionConsumerService",SingleLogoutService:"SingleLogoutService"},idp:{}},bindings:{"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect":"HTTP Redirect","urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST":"HTTP POST","urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact":"HTTP Artifact","urn:oasis:names:tc:SAML:2.0:bindings:SOAP":"SOAP",
"urn:oasis:names:tc:SAML:2.0:bindings:PAOS":"Reverse SOAP (PAOS)"},attributes:{"urn:oid:0.9.2342.19200300.100.1.1":"uid","urn:oid:0.9.2342.19200300.100.1.10":"manager","urn:oid:0.9.2342.19200300.100.1.2":"textEncodedORAddress","urn:oid:0.9.2342.19200300.100.1.20":"homePhone","urn:oid:0.9.2342.19200300.100.1.22":"otherMailbox","urn:oid:0.9.2342.19200300.100.1.3":"mail","urn:oid:0.9.2342.19200300.100.1.39":"homePostalAddress","urn:oid:0.9.2342.19200300.100.1.40":"personalTitle","urn:oid:0.9.2342.19200300.100.1.41":"mobile",
"urn:oid:0.9.2342.19200300.100.1.42":"pager","urn:oid:0.9.2342.19200300.100.1.43":"co","urn:oid:0.9.2342.19200300.100.1.6":"roomNumber","urn:oid:0.9.2342.19200300.100.1.60":"jpegPhoto","urn:oid:0.9.2342.19200300.100.1.7":"photo","urn:oid:1.2.840.113549.1.9.1":"email","urn:oid:1.3.6.1.4.1.2428.90.1.1":"norEduOrgUniqueNumber","urn:oid:1.3.6.1.4.1.2428.90.1.11":"norEduOrgSchemaVersion","urn:oid:1.3.6.1.4.1.2428.90.1.12":"norEduOrgNIN","urn:oid:1.3.6.1.4.1.2428.90.1.2":"norEduOrgUnitUniqueNumber","urn:oid:1.3.6.1.4.1.2428.90.1.3":"norEduPersonBirthDate",
"urn:oid:1.3.6.1.4.1.2428.90.1.4":"norEduPersonLIN","urn:oid:1.3.6.1.4.1.2428.90.1.5":"norEduPersonNIN","urn:oid:1.3.6.1.4.1.2428.90.1.6":"norEduOrgAcronym","urn:oid:1.3.6.1.4.1.2428.90.1.7":"norEduOrgUniqueIdentifier","urn:oid:1.3.6.1.4.1.2428.90.1.8":"norEduOrgUnitUniqueIdentifier","urn:oid:1.3.6.1.4.1.2428.90.1.9":"federationFeideSchemaVersion","urn:oid:1.3.6.1.4.1.250.1.57":"labeledURI","urn:oid:1.3.6.1.4.1.5923.1.1.1.1":"eduPersonAffiliation","urn:oid:1.3.6.1.4.1.5923.1.1.1.10":"eduPersonTargetedID",
"urn:oid:1.3.6.1.4.1.5923.1.1.1.2":"eduPersonNickname","urn:oid:1.3.6.1.4.1.5923.1.1.1.3":"eduPersonOrgDN","urn:oid:1.3.6.1.4.1.5923.1.1.1.4":"eduPersonOrgUnitDN","urn:oid:1.3.6.1.4.1.5923.1.1.1.5":"eduPersonPrimaryAffiliation","urn:oid:1.3.6.1.4.1.5923.1.1.1.6":"eduPersonPrincipalName","urn:oid:1.3.6.1.4.1.5923.1.1.1.7":"eduPersonEntitlement","urn:oid:1.3.6.1.4.1.5923.1.1.1.8":"eduPersonPrimaryOrgUnitDN","urn:oid:1.3.6.1.4.1.5923.1.1.1.9":"eduPersonScopedAffiliation","urn:oid:1.3.6.1.4.1.5923.1.2.1.2":"eduOrgHomePageURI",
"urn:oid:1.3.6.1.4.1.5923.1.2.1.3":"eduOrgIdentityAuthNPolicyURI","urn:oid:1.3.6.1.4.1.5923.1.2.1.4":"eduOrgLegalName","urn:oid:1.3.6.1.4.1.5923.1.2.1.5":"eduOrgSuperiorURI","urn:oid:1.3.6.1.4.1.5923.1.2.1.6":"eduOrgWhitePagesURI","urn:oid:1.3.6.1.4.1.5923.1.5.1.1":"isMemberOf","urn:oid:2.16.840.1.113730.3.1.241":"displayName","urn:oid:2.16.840.1.113730.3.1.3":"employeeNumber","urn:oid:2.16.840.1.113730.3.1.39":"preferredLanguage","urn:oid:2.16.840.1.113730.3.1.4":"employeeType","urn:oid:2.16.840.1.113730.3.1.40":"userSMIMECertificate",
"urn:oid:2.5.4.10":"o","urn:oid:2.5.4.11":"ou","urn:oid:2.5.4.12":"title","urn:oid:2.5.4.13":"description","urn:oid:2.5.4.16":"postalAddress","urn:oid:2.5.4.17":"postalCode","urn:oid:2.5.4.18":"postOfficeBox","urn:oid:2.5.4.19":"physicalDeliveryOfficeName","urn:oid:2.5.4.20":"telephoneNumber","urn:oid:2.5.4.21":"telexNumber","urn:oid:2.5.4.3":"cn","urn:oid:2.5.4.36":"userCertificate","urn:oid:2.5.4.4":"sn","urn:oid:2.5.4.41":"name","urn:oid:2.5.4.42":"givenName","urn:oid:2.5.4.7":"l","urn:oid:2.5.4.9":"street"}};
SAMLmetaJS.TestEngine=function(c){this.ruleset=typeof c==="undefined"||c===null?{}:c;this.tests=[]};SAMLmetaJS.TestEngine.prototype.addTest=function(c){if(this.ruleset.hasOwnProperty(c.id))console.log("Overriding significance from ["+c.significance+"] to ["+this.ruleset[c.id]+"] for ["+c.id+"]"),c.significance=this.ruleset[c.id];this.tests.push(c)};SAMLmetaJS.TestEngine.prototype.getResult=function(){return this.tests};SAMLmetaJS.TestEngine.prototype.reset=function(){this.tests=[]};SAMLmetaJS.sync=
function(f,e){var a="xml",b=void 0,d=false,l={info:true,warning:true,error:true,ok:true},h,g=function(a,b){var d=a.getResult(),e=0,l;l=c(f).parent().parent().find("div#samlmetajs_testresults");c(l).empty();for(e=0;e<d.length;e++)b[d[e].getLevel()]&&c(l).append(d[e].html())},k=function(){if(a==="xml"){a="other";console.log("fromXML()");h.reset();entitydescriptor=mdreader.parseFromString(c(f).val());var b=entitydescriptor.entityid;c("input#entityid").val(b);console.log(entitydescriptor);d===true&&g(h,
l);SAMLmetaJS.pluginEngine.execute("fromXML",[entitydescriptor])}},m=function(){if(a==="other"){a="xml";console.log("toXML()");var b={};b.entityid=c("input#entityid").val();SAMLmetaJS.pluginEngine.execute("toXML",[b]);console.log(b);var e=SAMLmetaJS.xmlupdater(c(f).val());e.updateDocument(b);b=e.getXMLasString();b=SAMLmetaJS.XML.prettifyXML(b);c(f).val(b);if(d===true)h.reset(),b=mdreader.parseFromString(c(f).val()),e=b.entityid,c("input#entityid").val(e),g(h,l),console.log(b)}};(function(){c(f).wrap('<div id="rawmetadata"></div>');
c(f).parent().wrap('<div id="tabs" />');var a=c(f).parent(),b=c(f).parent().parent(),d={list:[],content:[]};SAMLmetaJS.pluginEngine.execute("addTab",[d]);a.append('<div><button class="prettify">Pretty format</button><button class="wipe">Wipe</button></div>');b.prepend('<ul><li><a href="#rawmetadata">Metadata</a></li>'+d.list.join("")+"</ul>");b.prepend('<div id="samlmetajs_testresults"></div>');b.append(d.content.join(""));b.tabs()})();if(e.ruleset)b=e.ruleset;if(e.showValidation)d=e.showValidation;
if(e.showValidationLevel)l=e.showValidationLevel;h=new SAMLmetaJS.TestEngine(b);mdreader.setup({testProcessor:function(a){h.addTest(a)}});c("a[href='#rawmetadata']").click(m);SAMLmetaJS.pluginEngine.execute("tabClick",[function(a){c(a).click(k)}]);e&&e.savehook&&c(e.savehook).submit(m);c("div#rawmetadata button.prettify").click(function(a){a.preventDefault();c(f).val(SAMLmetaJS.XML.prettifyXML(c(f).val()))});c("div#rawmetadata button.wipe").click(function(a){a.preventDefault();c(f).val("")});SAMLmetaJS.pluginEngine.execute("setUp",
[])};c.vari="$.vari";c.fn.foo="$.fn.vari";c.fn.SAMLmetaJS=function(c){return this.each(function(){SAMLmetaJS.sync(this,c)})}})(jQuery);
SAMLmetaJS.xmlupdater=function(c){var f=null,e=null,f=new DOMParser,e=f.parseFromString(c,"text/xml");return{updateDocument:function(a){console.log("Update XML document");var b,d,c,f,g;b=this.addIfNotEntityDescriptor();a.entityid&&b.setAttribute("entityID",a.entityid);if(a.entityAttributes)for(d in entityExtensions=this.addIfNotEntityExtensions(b),entityAttributes=this.addIfNotEntityAttributes(entityExtensions),SAMLmetaJS.XML.wipeChildren(entityAttributes,SAMLmetaJS.Constants.ns.saml,"Attribute"),
a.entityAttributes)this.addAttribute(entityAttributes,a.entityAttributes[d]);d=this.addIfNotSPSSODescriptor(b);SAMLmetaJS.tools.hasContents(a.name)||SAMLmetaJS.tools.hasContents(a.descr)||a.location?(c=this.addIfNotExtensions(d),mdui=this.addIfNotMDUI(c),this.updateMDUI(mdui,a)):SAMLmetaJS.XML.wipeChildren(d,SAMLmetaJS.Constants.ns.md,"Extensions");SAMLmetaJS.XML.wipeChildren(d,SAMLmetaJS.Constants.ns.md,"KeyDescriptor");if(a.saml2sp&&a.saml2sp.certs)for(c=0;c<a.saml2sp.certs.length;c++)this.addCert(d,
a.saml2sp.certs[c].use,a.saml2sp.certs[c].cert);SAMLmetaJS.XML.wipeChildren(d,SAMLmetaJS.Constants.ns.md,"AssertionConsumerService");if(a.saml2sp&&a.saml2sp.AssertionConsumerService&&a.saml2sp.AssertionConsumerService.length>0)for(c=0;c<a.saml2sp.AssertionConsumerService.length;c++)this.addEndpoint(d,"AssertionConsumerService",a.saml2sp.AssertionConsumerService[c]);SAMLmetaJS.XML.wipeChildren(d,SAMLmetaJS.Constants.ns.md,"SingleLogoutService");if(a.saml2sp&&a.saml2sp.SingleLogoutService&&a.saml2sp.SingleLogoutService.length>
0)for(c=0;c<a.saml2sp.SingleLogoutService.length;c++)this.addEndpoint(d,"SingleLogoutService",a.saml2sp.SingleLogoutService[c]);if(SAMLmetaJS.tools.hasContents(a.name)&&a.saml2sp&&a.saml2sp.acs&&SAMLmetaJS.tools.hasContents(a.saml2sp.acs.attributes))for(f in d=this.addIfNotAttributeConsumingService(d),this.updateAttributeConsumingService(d,a),a.saml2sp.acs.attributes)this.addRequestedAttribute(d,f);else SAMLmetaJS.XML.wipeChildren(d,SAMLmetaJS.Constants.ns.md,"AttributeConsumingService");if(a.contacts){SAMLmetaJS.XML.wipeChildren(b,
SAMLmetaJS.Constants.ns.md,"ContactPerson");for(c=0;c<a.contacts.length;c++)this.addContact(b,a.contacts[c])}else SAMLmetaJS.XML.wipeChildren(b,SAMLmetaJS.Constants.ns.md,"ContactPerson");if(a.organization){SAMLmetaJS.XML.wipeChildren(b,SAMLmetaJS.Constants.ns.md,"Organization");f=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:Organization");if(a.organization.name)for(g in a.organization.name)a.organization.name.hasOwnProperty(g)&&this.addOrganizationElement(f,"OrganizationName",g,a.organization.name[g]);
if(a.organization.displayname)for(g in a.organization.displayname)a.organization.displayname.hasOwnProperty(g)&&this.addOrganizationElement(f,"OrganizationDisplayName",g,a.organization.displayname[g]);if(a.organization.url)for(g in a.organization.url)a.organization.url.hasOwnProperty(g)&&this.addOrganizationElement(f,"OrganizationURL",g,a.organization.url[g]);b.insertBefore(f,SAMLmetaJS.XML.findChildElement(b,[{localName:"ContactPerson",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AdditionalMetadataLocation",
namespaceURI:SAMLmetaJS.Constants.ns.md}]))}else SAMLmetaJS.XML.wipeChildren(b,SAMLmetaJS.Constants.ns.md,"Organization")},addCert:function(a,b,d){var c,f,g;c=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:KeyDescriptor");(b==="signing"||b==="encryption")&&c.setAttribute("use",b);b=e.createElementNS(SAMLmetaJS.Constants.ns.ds,"ds:KeyInfo");f=e.createElementNS(SAMLmetaJS.Constants.ns.ds,"ds:X509Data");g=e.createElementNS(SAMLmetaJS.Constants.ns.ds,"ds:X509Certificate");g.appendChild(e.createTextNode(d));
f.appendChild(g);b.appendChild(f);c.appendChild(b);a.insertBefore(c,SAMLmetaJS.XML.findChildElement(a,[{localName:"SingleLogoutService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AssertionConsumerService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AttributeConsumingService",namespaceURI:SAMLmetaJS.Constants.ns.md}]))},addContact:function(a,b){var d,c=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:ContactPerson");b.contactType&&c.setAttribute("contactType",b.contactType);b.givenName&&
(d=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:GivenName"),d.appendChild(e.createTextNode(b.givenName)),c.appendChild(d));b.surName&&(d=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:SurName"),d.appendChild(e.createTextNode(b.surName)),c.appendChild(d));b.emailAddress&&(d=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:EmailAddress"),d.appendChild(e.createTextNode(b.emailAddress)),c.appendChild(d));a.insertBefore(c,SAMLmetaJS.XML.findChildElement(a,[{localName:"AdditionalMetadataLocation",
namespaceURI:SAMLmetaJS.Constants.ns.md}]))},addOrganizationElement:function(a,b,d,c){b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:"+b);b.setAttribute("xml:lang",d);b.appendChild(e.createTextNode(c));a.appendChild(b)},updateMDUI:function(a,b){if(SAMLmetaJS.tools.hasContents(b.name))for(lang in SAMLmetaJS.XML.wipeChildren(a,SAMLmetaJS.Constants.ns.mdui,"DisplayName"),b.name)this.addMDUIDisplayName(a,lang,b.name[lang]);if(SAMLmetaJS.tools.hasContents(b.descr))for(lang in SAMLmetaJS.XML.wipeChildren(a,
SAMLmetaJS.Constants.ns.mdui,"Description"),b.descr)this.addMDUIDescription(a,lang,b.descr[lang]);SAMLmetaJS.XML.wipeChildren(a,SAMLmetaJS.Constants.ns.mdui,"GeolocationHint");b.location&&this.addMDUILocation(a,b.location)},addMDUILocation:function(a,b){var d=e.createElementNS(SAMLmetaJS.Constants.ns.mdui,"mdui:GeolocationHint"),c=e.createTextNode("geo:"+b);d.appendChild(c);a.appendChild(d)},addMDUIDisplayName:function(a,b,d){var c=e.createElementNS(SAMLmetaJS.Constants.ns.mdui,"mdui:DisplayName"),
d=e.createTextNode(d);c.setAttribute("xml:lang",b);c.appendChild(d);a.appendChild(c)},addMDUIDescription:function(a,b,d){var c=e.createElementNS(SAMLmetaJS.Constants.ns.mdui,"mdui:Description"),d=e.createTextNode(d);c.setAttribute("xml:lang",b);c.appendChild(d);a.appendChild(c)},updateAttributeConsumingService:function(a,b){var d,e;for(d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];c.nodeType==1&&c.namespaceURI===SAMLmetaJS.Constants.ns.md&&a.removeChild(c)}if(b.name)for(e in b.name)this.addName(a,
e,b.name[e]);if(b.descr)for(e in b.descr)this.addDescr(a,e,b.descr[e])},addName:function(a,b,d){var c=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:ServiceName"),d=e.createTextNode(d);c.setAttribute("xml:lang",b);c.appendChild(d);a.appendChild(c)},addDescr:function(a,b,d){var c=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:ServiceDescription"),d=e.createTextNode(d);c.setAttribute("xml:lang",b);c.appendChild(d);a.appendChild(c)},addRequestedAttribute:function(a,b){var d=e.createElementNS(SAMLmetaJS.Constants.ns.md,
"md:RequestedAttribute");d.setAttribute("Name",b);d.setAttribute("NameFormat","urn:oasis:names:tc:SAML:2.0:attrname-format:uri");a.appendChild(d)},addAttribute:function(a,b){var d=e.createElementNS(SAMLmetaJS.Constants.ns.saml,"saml:Attribute");d.setAttribute("Name",b.name);b.nameFormat&&d.setAttribute("NameFormat",b.nameFormat);if(b.values)for(var c=0;c<b.values.length;c++){var f=e.createElementNS(SAMLmetaJS.Constants.ns.saml,"saml:AttributeValue");f.appendChild(e.createTextNode(b.values[c]));d.appendChild(f)}a.appendChild(d)},
addIfNotEntityExtensions:function(a){var b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="Extensions"&&d.namespaceURI===SAMLmetaJS.Constants.ns.md)return d}b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:Extensions");a.insertBefore(b,SAMLmetaJS.XML.findChildElement(a,[{localName:"SPSSODescriptor",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"IdPSSODescriptor",namespaceURI:SAMLmetaJS.Constants.ns.md}]));return b},addIfNotExtensions:function(a){var b;
for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="Extensions"&&d.namespaceURI===SAMLmetaJS.Constants.ns.md)return d}b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:Extensions");a.insertBefore(b,SAMLmetaJS.XML.findChildElement(a,[{localName:"KeyDescriptor",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"SingleLogoutService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AssertionConsumerService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AttributeConsumingService",
namespaceURI:SAMLmetaJS.Constants.ns.md}]));return b},addIfNotMDUI:function(a){var b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="UIInfo"&&d.namespaceURI===SAMLmetaJS.Constants.ns.mdui)return d}b=e.createElementNS(SAMLmetaJS.Constants.ns.mdui,"mdui:UIInfo");a.appendChild(b);return b},addIfNotEntityAttributes:function(a){var b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="EntityAttributes"&&d.namespaceURI===SAMLmetaJS.Constants.ns.mdattr)return d}b=
e.createElementNS(SAMLmetaJS.Constants.ns.mdattr,"mdattr:EntityAttributes");a.appendChild(b);return b},addIfNotAttributeConsumingService:function(a){var b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="AttributeConsumingService"&&d.namespaceURI===SAMLmetaJS.Constants.ns.md)return d}b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:AttributeConsumingService");b.setAttribute("index",0);a.insertBefore(b,SAMLmetaJS.XML.findChildElement(a,[{localName:"ContactPerson",
namespaceURI:SAMLmetaJS.Constants.ns.md}]));return b},addEndpoint:function(a,b,d){b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:"+b);d.Binding&&b.setAttribute("Binding",d.Binding);d.Location&&b.setAttribute("Location",d.Location);d.ResponseLocation&&b.setAttribute("ResponseLocation",d.ResponseLocation);d.index&&b.setAttribute("index",d.index);a.insertBefore(b,SAMLmetaJS.XML.findChildElement(a,[{localName:"SingleLogoutService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"ManageNameIDService",
namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"NameIDFormat",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AssertionConsumerService",namespaceURI:SAMLmetaJS.Constants.ns.md},{localName:"AttributeConsumingService",namespaceURI:SAMLmetaJS.Constants.ns.md}]))},addIfNotSPSSODescriptor:function(a){var b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.nodeType==1&&d.localName==="SPSSODescriptor"&&d.namespaceURI===SAMLmetaJS.Constants.ns.md&&SAMLmetaJS.XML.hasAttribute(d,"protocolSupportEnumeration",
"urn:oasis:names:tc:SAML:2.0:protocol"))return d}b=e.createElementNS(SAMLmetaJS.Constants.ns.md,"md:SPSSODescriptor");b.setAttribute("protocolSupportEnumeration","urn:oasis:names:tc:SAML:2.0:protocol");a.appendChild(b);return b},addIfNotEntityDescriptor:function(){var a=e.documentElement;if(a===null||a.localName!=="EntityDescriptor"||a.namespaceURI!==SAMLmetaJS.Constants.ns.md)a=this.addEntityDescriptor();return a},addEntityDescriptor:function(){var a=e.createElementNS(SAMLmetaJS.Constants.ns.md,
"md:EntityDescriptor");a.setAttribute("xmlns:ds",SAMLmetaJS.Constants.ns.ds);e.documentElement!==null&&e.removeChild(e.documentElement);e.appendChild(a);return a},getXMLasString:function(){return(new XMLSerializer).serializeToString(e)}}};SAMLmetaJS.tools={hasContents:function(c){if(!c)return false;for(key in c)return true;return false}};
SAMLmetaJS.XML={hasAttribute:function(c,f,e){c=c.getAttribute(f);if(!c)return false;c=c.split(" ");for(key in c)if(c[key]==e)return true;return false},getText:function(c){if(c.hasChildNodes()){for(var f="",e=0;e<c.childNodes.length;e++)c.childNodes[e].nodeType==3&&(f+=c.childNodes[e].nodeValue);f=f.replace(/\s+/g," ");f=f.replace(/^\s*/g,"");return f=f.replace(/\s*$/g,"")}},wipeChildren:function(c,f,e){var a,b=[];if(c.childNodes){for(a=0;a<c.childNodes.length;a++){var d=c.childNodes[a];d.nodeType===
1&&(f&&f!==d.namespaceURI||e&&e!==d.localName||b.push(d))}for(a=0;a<b.length;a++)c.removeChild(b[a])}},findChildElement:function(c,f){var e,a;for(e=0;e<c.childNodes.length;e++){var b=c.childNodes[e];if(b.nodeType===1)for(a=0;a<f.length;a++)if(f[a].localName==b.localName&&f[a].namespaceURI==b.namespaceURI)return b}return null},prettifyXML:function(c){function f(a){a=a.replace(/&/g,"&amp;");a=a.replace(/\"/g,"&qout;");a=a.replace(/'/g,"&apos;");a=a.replace(/</,"&lt;");return a=a.replace(/>/,"&gt;")}
function e(a,b){for(var d=b+"<"+a.nodeName,c=b;c.length<d.length;)c+=" ";for(var h=a.attributes,g=0;g<h.length;g++){var k=h.item(g);g>0&&(d+="\n"+c);d+=" "+k.nodeName+'="'+f(k.value)+'"'}a:{g=/^s*$/;for(k=a.firstChild;k!=null;k=k.nextSibling)if(!(k instanceof Text&&g.test(k.data))){g=false;break a}g=true}if(g)return h.length>1?d+"\n"+c+" />\n":h.length==1?d+" />\n":d+"/>\n";d+=h.length>1?"\n"+c+" >":">";a:{for(c=a.firstChild;c!=null;c=c.nextSibling)if(!(c instanceof Text)){c=false;break a}c=true}if(c)return d+
f(a.textContent)+"</"+a.nodeName+">\n";d+="\n";for(c=a.firstElementChild;c!=null;c=c.nextElementSibling)d+=e(c,b+"\t ");return d+b+"</"+a.nodeName+">\n"}c=(new DOMParser).parseFromString(c,"text/xml");return e(c.documentElement,"")}};
(function(c){var f={clearInfoname:function(){c("div#info div#infoname").empty()},clearInfodescr:function(){c("div#info div#infodescr").empty()},addInfoname:function(e,a){var b="infoname"+Math.floor(Math.random()*1E4+1E3),d='<div class="infonamediv"><select name="'+b+'-lang-name" id="'+b+'-lang">',f=false,h,g;for(h in SAMLmetaJS.Constants.languages)SAMLmetaJS.Constants.languages.hasOwnProperty(h)&&(g="",e===h&&(g=' selected="selected" ',f=true),d+='<option value="'+h+'" '+g+">"+SAMLmetaJS.Constants.languages[h]+
"</option>");f||(d+='<option value="'+e+'" selected="selected">Unknown language ('+e+")</option>");d+='</select><input type="text" name="'+b+'-name-name" id="'+b+'-name" value="'+(a||"")+'" /><button style="" class="removename">Remove</button></div>';c(d).appendTo("div#info div#infoname").find("button.removename").click(function(a){a.preventDefault();c(a.target).closest("div.infonamediv").remove()})},addInfodescr:function(e,a){var b="infodescr"+Math.floor(Math.random()*1E4+1E3),d='<div class="infodescrdiv"><div><select name="'+
b+'-lang-name" id="'+b+'-lang">',f=false,h,g;for(h in SAMLmetaJS.Constants.languages)SAMLmetaJS.Constants.languages.hasOwnProperty(h)&&(g="",e===h&&(g=' selected="selected" ',f=true),d+='<option value="'+h+'" '+g+">"+SAMLmetaJS.Constants.languages[h]+"</option>");f||(d+='<option value="'+e+'" selected="selected">Unknown language ('+e+")</option>");d+='</select><button style="" class="removedescr">Remove</button></div><div><textarea name="'+b+'-name-name" id="'+b+'-name">'+(a||"")+"</textarea></div></div>";
c(d).appendTo("div#info div#infodescr").find("button.removedescr").click(function(a){a.preventDefault();c(a.target).closest("div.infodescrdiv").remove()})}};SAMLmetaJS.plugins.info={tabClick:function(e){e(c("a[href='#info']"))},addTab:function(c){c.list.push('<li><a href="#info">Information</a></li>');c.content.push('<div id="info"><fieldset class="entityid"><legend>Entity ID</legend><div id="div-entityid"><input style="width: 600px" type="text" name="entityid" id="entityid" value="" /><p style="margin: 0px">The format MUST be an URI.</p></div></fieldset><fieldset class="name"><legend>Name of Service</legend><div id="infoname"></div><div><button class="addname">Add name in one more language</button></div></fieldset><fieldset class="description"><legend>Description of Service</legend><div id="infodescr"></div><div><button class="adddescr">Add description in one more language</button></div></fieldset></div>')},
setUp:function(){c("div#info button.addname").click(function(c){c.preventDefault();f.addInfoname("en","")});c("div#info button.adddescr").click(function(c){c.preventDefault();f.addInfodescr("en","")})},fromXML:function(c){var a;f.clearInfoname();if(c.name)for(a in c.name)c.name.hasOwnProperty(a)&&f.addInfoname(a,c.name[a]);f.clearInfodescr();if(c.descr)for(a in c.descr)c.descr.hasOwnProperty(a)&&f.addInfodescr(a,c.descr[a])},toXML:function(e){c("div#infoname > div").each(function(a,b){var d=c(b).children("input").attr("value");
if(d){if(!e.name)e.name={};e.name[c(b).children("select").val()]=d}});c("div#infodescr > div").each(function(a,b){var d=c(b).find("div > textarea").val();if(d){if(!e.descr)e.descr={};e.descr[c(b).find("div > select").val()]=d}})}}})(jQuery);
(function(c){function f(e,a){var b,d,f,h="cert"+Math.floor(Math.random()*1E4+1E3);b='<fieldset><legend>Certificate</legend><select class="certuse" name="'+h+'-use-name" id="'+h+'-use">';for(d in SAMLmetaJS.Constants.certusage)SAMLmetaJS.Constants.certusage.hasOwnProperty(d)&&(f="",d===e&&(f=' selected="selected" '),b+='<option value="'+d+'" '+f+">"+SAMLmetaJS.Constants.certusage[d]+"</option>");b+='</select><textarea class="certdata" style="" name="'+h+'-data" id="'+h+'-data-name">'+(a||"")+'</textarea><button style="display: block" class="removecert">Remove</button></fieldset>';
c(b).appendTo("div#certs > div.content").find("button.removecert").click(function(a){a.preventDefault();c(a.target).closest("fieldset").remove()})}SAMLmetaJS.plugins.certs={tabClick:function(e){e(c("a[href='#certs']"))},addTab:function(c){c.list.push('<li><a href="#certs">Certificates</a></li>');c.content.push('<div id="certs"><div class="content"></div><div><button class="addcert">Add new certificate</button></div></div>')},setUp:function(){c("div#certs button.addcert").click(function(c){c.preventDefault();
f("both","")})},fromXML:function(e){var a;c("div#certs > div.content").empty();if(e.saml2sp&&e.saml2sp.certs)for(a in e.saml2sp.certs)e.saml2sp.certs.hasOwnProperty(a)&&f(e.saml2sp.certs[a].use,e.saml2sp.certs[a].cert)},toXML:function(e){delete e.certs;c("div#certs fieldset").each(function(a,b){var d=c(b).find("select.certuse").val(),f=c(b).find("textarea.certdata").val();if(d&&f){if(!e.saml2sp)e.saml2sp={};if(!e.saml2sp.certs)e.saml2sp.certs=[];e.saml2sp.certs.push({use:d,cert:f})}})}}})(jQuery);
(function(c){function f(e,a){var b,d,f,h,g="endpoint-"+Math.floor(Math.random()*1E4+1E3);d="<fieldset><legend>"+(a||"Endpoint")+'</legend><div class="endpointfield"><label for="'+g+'-type">Endpoint type: </label><select class="datafield-type" name="'+g+'-type-name" id="'+g+'-type">';for(f in SAMLmetaJS.Constants.endpointTypes.sp)SAMLmetaJS.Constants.endpointTypes.sp.hasOwnProperty(f)&&(b="",f===a&&(b=' selected="selected" '),d+='<option value="'+f+'" '+b+">"+SAMLmetaJS.Constants.endpointTypes.sp[f]+
"</option>");d+="</select></div>";e.index&&(d+='<input type="hidden" class="datafield-index" id="'+g+'-binding" name="'+g+'-index-name" value="'+e.index+'" />');d+='<div class="endpointfield"><label for="'+g+'-binding">Binding: </label><select class="datafield-binding" name="'+g+'-binding-name" id="'+g+'-binding">';f=false;for(h in SAMLmetaJS.Constants.bindings)SAMLmetaJS.Constants.bindings.hasOwnProperty(h)&&(b="",e.Binding===h&&(b=' selected="selected" ',f=true),d+='<option value="'+h+'" '+b+">"+
SAMLmetaJS.Constants.bindings[h]+"</option>");e.Binding&&!f&&(d+='<option value="'+e.Binding+'" selected="selected">Unknown binding ('+e.Binding+")</option>");d+="</select></div>";d+='<div class="endpointfield endpointfield-location"><label for="'+g+'-location">\tLocation</label><input class="datafield-location" type="text" name="'+g+'-location-name" id="contact-'+g+'-location" value="'+(e.Location||"")+'" /></div>';d+='<div class="endpointfield"><label for="'+g+'-locationresponse">\tResponse location</label><input class="datafield-responselocation" type="text" name="'+
g+'-locationresponse-name" id="contact-'+g+'-locationresponse" value="'+(e.ResponseLocation||"")+'" /></div>';d+='<button style="display: block; clear: both" class="remove">Remove</button></fieldset>';c(d).appendTo("div#saml2sp > div.content").find("button.remove").click(function(a){a.preventDefault();c(a.target).closest("fieldset").remove()})}SAMLmetaJS.plugins.saml2sp={tabClick:function(e){e(c("a[href='#saml2sp']"))},addTab:function(c){c.list.push('<li><a href="#saml2sp">SAML Endpoints</a></li>');
c.content.push('<div id="saml2sp"><div class="content"></div><div><button class="addendpoint">Add new endpoint</button></div></div>')},setUp:function(){c("div#saml2sp button.addendpoint").click(function(c){c.preventDefault();f({})})},fromXML:function(e){var a,b;c("div#saml2sp > div.content").empty();if(e.saml2sp)for(b in e.saml2sp)if(e.saml2sp.hasOwnProperty(b)&&!(b!=="AssertionConsumerService"&&b!=="SingleLogoutService"))for(a=0;a<e.saml2sp[b].length;a++)f(e.saml2sp[b][a],b)},toXML:function(e){var a=
1,b={};c("div#saml2sp fieldset").each(function(d,f){var h={},g;if(c(f).find("input").eq(0).attr("value")){g=c(f).find("select.datafield-type").val();h.Binding=c(f).find("select.datafield-binding").attr("value");h.Location=c(f).find("input.datafield-location").attr("value");h.ResponseLocation=c(f).find("input.datafield-responselocation").attr("value");d=c(f).find("input.datafield-index").attr("value");if(!d&&g==="AssertionConsumerService"){for(;b[a];)a++;d=a}if(d)b[d]=1,h.index=d;if(!e.saml2sp)e.saml2sp=
{};e.saml2sp[g]||(e.saml2sp[g]=[]);e.saml2sp[g].push(h)}})}}})(jQuery);
(function(c){SAMLmetaJS.plugins.fedlab={tabClick:function(f){f(c("a[href='#fedlab']"))},addTab:function(c){c.list.push('<li><a href="#fedlab">FedLab</a></li>');c.content.push('<div id="fedlab"><div class="content"><p>Here you may register some additional parameters required by some of the Federation Lab Tools.</p><fieldset class="automatedtester"><legend>Automated SP Tester</legend><div id="div-initsso"><p style="font-weight: bold; color: #333; margin: .5em 0px .1em 0px">Initiate SSO URL</p><input style="width: 600px" type="text" name="fedlab_initsso" id="fedlab_initsso" value="" /><p style="margin: 0px">An URL that initiates login at the service provider. Request to this page  should also be automatically directed to the automated SP tester, and not show a discovery service.</p></div><div id="div-attributeurl"><p style="font-weight: bold; color: #333; margin: .5em 0px .1em 0px">Attribute viewer URL</p><input style="width: 600px" type="text" name="fedlab_attributeurl" id="fedlab_attributeurl" value="" /><p style="margin: 0px">An URL at the service provider that presents a list of attributes for the  currently authenticated user.</p></div><div id="div-initslo"><p style="font-weight: bold; color: #333; margin: .5em 0px .1em 0px">Initiate Single Log-Out URL</p><input style="width: 600px" type="text" name="fedlab_initslo" id="fedlab_initslo" value="" /><p style="margin: 0px">An URL that initiates SLO at the service provider.</p></div></fieldset></div></div>')},fromXML:function(f){var e=
SAMLmetaJS.plugins.fedlab._getAttribute(f.entityAttributes,"https://www.fed-lab.org/attributes/initsso"),a=SAMLmetaJS.plugins.fedlab._getAttribute(f.entityAttributes,"https://www.fed-lab.org/attributes/attributeurl"),f=SAMLmetaJS.plugins.fedlab._getAttribute(f.entityAttributes,"https://www.fed-lab.org/attributes/initslo");c("div#fedlab > div.content input#fedlab_initsso").val(e);c("div#fedlab > div.content input#fedlab_attributeurl").val(a);c("div#fedlab > div.content input#fedlab_initslo").val(f)},
toXML:function(f){var e=c("div#fedlab > div.content input#fedlab_initsso").val(),a=c("div#fedlab > div.content input#fedlab_attributeurl").val(),b=c("div#fedlab > div.content input#fedlab_initslo").val();if(e||a||b){if(!f.entityAttributes)f.entityAttributes={};e?f.entityAttributes["https://www.fed-lab.org/attributes/initsso"]={name:"https://www.fed-lab.org/attributes/initsso",values:[e],nameFormat:"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"}:delete f.entityAttributes["https://www.fed-lab.org/attributes/initsso"];
a?f.entityAttributes["https://www.fed-lab.org/attributes/attributeurl"]={name:"https://www.fed-lab.org/attributes/attributeurl",values:[a],nameFormat:"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"}:delete f.entityAttributes["https://www.fed-lab.org/attributes/attributeurl"];b?f.entityAttributes["https://www.fed-lab.org/attributes/initslo"]={name:"https://www.fed-lab.org/attributes/initslo",values:[b],nameFormat:"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"}:delete f.entityAttributes["https://www.fed-lab.org/attributes/initslo"];
console.log("Dump entity attributes in federation lab plugin");console.log(f.entityAttributes)}}};SAMLmetaJS.plugins.fedlab._getAttribute=function(c,e){console.log("Looking up attribute ["+e+"]");return!c?"":!c[e]?"":!c[e].values?"":!c[e].values[0]?"":c[e].values[0]}})(jQuery);
